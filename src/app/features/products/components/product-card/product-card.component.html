<div
  class="group bg-card rounded-xl overflow-hidden border border-border hover:border-primary hover:shadow-lg transition-all h-full flex flex-col shadow-sm"
>
  <!-- Product Image -->
  <a [routerLink]="['/products', product.id]" class="block cursor-pointer flex-shrink-0">
    <div class="product-image-container">
      <img
        [src]="product.image"
        [alt]="product.title"
        class="product-image"
      />
    </div>
  </a>

  <!-- Product Info -->
  <div class="p-5 flex flex-col gap-3 flex-1">
    <a
      [routerLink]="['/products', product.id]"
      class="text-sm font-medium text-foreground line-clamp-2 group-hover:text-primary transition-colors cursor-pointer min-h-[2.5rem] flex items-start"
    >
      {{ product.title }}
    </a>

    @if (product.rating) {
      <div class="flex items-center gap-1.5 text-xs flex-shrink-0">
        <div class="flex items-center gap-0.5">
          <svg class="w-3.5 h-3.5 text-yellow-500 fill-yellow-500" viewBox="0 0 24 24">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
        </div>
        <span class="font-semibold text-foreground">{{ product.rating.rate.toFixed(1) }}</span>
        <span class="text-muted-foreground">({{ product.rating.count }})</span>
      </div>
    } @else {
      <div class="h-5 flex-shrink-0"></div>
    }

    <div class="flex items-center justify-between pt-2 border-t border-border mt-auto flex-shrink-0">
      <span class="price-tag text-lg font-bold">{{ product.price | currency:'USD':'symbol':'1.2-2' }}</span>
      <div class="flex gap-2">
        <button
          (click)="onAddToCart.emit(product)"
          class="p-2 bg-gradient-to-br from-primary to-primary/90 text-primary-foreground rounded-xl hover:from-primary/90 hover:to-primary/80 transition-all shadow-sm hover:shadow-md"
          title="Agregar al carrito"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 4v16m8-8H4"
            />
          </svg>
        </button>
        <button
          (click)="onEdit.emit(product)"
          class="p-2 bg-gradient-to-br from-blue-500/10 to-blue-400/10 text-blue-600 rounded-xl hover:from-blue-500/20 hover:to-blue-400/20 transition-all border border-blue-500/20 hover:border-blue-500/40"
          title="Editar"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
            />
          </svg>
        </button>
        <button
          (click)="onDelete.emit(product.id)"
          [disabled]="deleting"
          class="p-2 bg-gradient-to-br from-destructive/10 to-destructive/5 text-destructive rounded-xl hover:from-destructive/20 hover:to-destructive/10 transition-all border border-destructive/20 hover:border-destructive/40 disabled:opacity-50 disabled:cursor-not-allowed"
          title="Eliminar"
        >
          @if (deleting) {
            <svg class="w-4 h-4 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
          } @else {
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
              />
            </svg>
          }
        </button>
      </div>
    </div>
  </div>
</div>

